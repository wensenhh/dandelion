(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-my-cropper-cropper"],{"114a":function(t,i,e){"use strict";e.r(i);var a=e("2a7e"),n=e("1c5e");for(var o in n)"default"!==o&&function(t){e.d(i,t,(function(){return n[t]}))}(o);e("19df");var c,s=e("f0c5"),h=e("de4e"),u=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,"1a52535e",null,!1,a["a"],c);"function"===typeof h["a"]&&Object(h["a"])(u),i["default"]=u.exports},"19df":function(t,i,e){"use strict";var a=e("bfed"),n=e.n(a);n.a},"1c5e":function(t,i,e){"use strict";e.r(i);var a=e("1f34"),n=e.n(a);for(var o in a)"default"!==o&&function(t){e.d(i,t,(function(){return a[t]}))}(o);i["default"]=n.a},"1f34":function(t,i,e){"use strict";var a=e("4ea4");e("ace4"),e("a9e3"),e("d3b7"),e("5cc6"),e("9a8c"),e("a975"),e("735e"),e("c1ac"),e("d139"),e("3a7b"),e("d5d6"),e("82f8"),e("e91f"),e("60bd"),e("5f96"),e("3280"),e("3fcc"),e("ca91"),e("25a1"),e("cd26"),e("2954"),e("649e"),e("219c"),e("b39a"),e("72f7"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=a(e("5530"));e("96cf");var o=a(e("1da1")),c={name:"tuiPictureCropper",emits:["ready","cropper","initAngle","imageLoad"],props:{imageUrl:{type:String,default:""},height:{type:Number,default:280},width:{type:Number,default:280},minWidth:{type:Number,default:100},minHeight:{type:Number,default:100},maxWidth:{type:Number,default:360},maxHeight:{type:Number,default:360},borderColor:{type:String,default:"rgba(255,255,255,0.1)"},edgeColor:{type:String,default:"#FFFFFF"},edgeWidth:{type:String,default:"34rpx"},edgeBorderWidth:{type:String,default:"6rpx"},edgeOffsets:{type:String,default:"6rpx"},lockWidth:{type:Boolean,default:!1},lockHeight:{type:Boolean,default:!1},lockRatio:{type:Boolean,default:!1},scaleRatio:{type:Number,default:2},quality:{type:Number,default:.8},rotateAngle:{type:Number,default:0},minScale:{type:Number,default:.5},maxScale:{type:Number,default:2},disableRotate:{type:Boolean,default:!0},limitMove:{type:Boolean,default:!0},custom:{type:Boolean,default:!1},startCutting:{type:[Number,Boolean],default:0},isBase64:{type:Boolean,default:!1},loadding:{type:Boolean,default:!0},rotateImg:{type:String,default:"/static/components/cropper/img_rotate.png"}},data:function(){return{TIME_CUT_CENTER:null,CROPPER_WIDTH:200,CROPPER_HEIGHT:200,cutX:0,cutY:0,canvasWidth:0,canvasHeight:0,imgWidth:0,imgHeight:0,scale:1,angle:0,cutAnimation:!1,cutAnimationTime:null,imgTop:0,imgLeft:0,ctx:null,sysInfo:{},props:"",sizeChange:0,angleChange:0,resetChange:0,centerChange:0}},watch:{imageUrl:function(t,i){var e=this;this.imageReset(),this.showLoading(),uni.getImageInfo({src:t,success:function(t){e.imgComputeSize(t.width,t.height),e.limitMove&&(e.angleChange++,e.props="3,".concat(e.angleChange))},fail:function(t){e.imgComputeSize(),e.limitMove&&(e.angleChange++,e.props="3,".concat(e.angleChange))}})},rotateAngle:function(t){this.cutAnimation=!0,this.angle=t,this.angleChanged(t)},cutAnimation:function(t){var i=this;clearTimeout(this.cutAnimationTime),t&&(this.cutAnimationTime=setTimeout((function(){i.cutAnimation=!1}),260))},limitMove:function(t){t&&this.angleChanged(this.angle)},startCutting:function(t){this.custom&&t&&this.getImage()}},mounted:function(){var t=this;this.sysInfo=uni.getSystemInfoSync(),this.imgTop=this.sysInfo.windowHeight/2,this.imgLeft=this.sysInfo.windowWidth/2,this.CROPPER_WIDTH=this.width,this.CROPPER_HEIGHT=this.height,this.canvasHeight=this.height,this.canvasWidth=this.width,this.ctx=uni.createCanvasContext("tui-image-cropper",this),setTimeout((function(){t.props="1,1"}),0),setTimeout((function(){t.$emit("ready",{})}),200)},methods:{getLocalImage:function(t){return(0,o.default)(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,new Promise((function(i,e){uni.downloadFile({url:t,success:function(t){i(t.tempFilePath)},fail:function(t){e(!1)}})}));case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}}),i)})))()},getImage:function(){var t=this;if(this.imageUrl){this.loadding&&this.showLoading();var i=function(){var i=(0,o.default)(regeneratorRuntime.mark((function i(){var e,a,o,c,s;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:e=t.imgWidth*t.scale*t.scaleRatio,a=t.imgHeight*t.scale*t.scaleRatio,o=t.imgLeft-t.cutX,c=t.imgTop-t.cutY,t.ctx.translate(o*t.scaleRatio,c*t.scaleRatio),t.ctx.rotate(t.angle*Math.PI/180),s=t.imageUrl,t.ctx.drawImage(s,-e/2,-a/2,e,a),t.ctx.draw(!1,(function(){var i={width:t.canvasWidth*t.scaleRatio,height:Math.round(t.canvasHeight*t.scaleRatio),destWidth:t.canvasWidth*t.scaleRatio,destHeight:Math.round(t.canvasHeight)*t.scaleRatio,fileType:"png",quality:t.quality},e={url:"",base64:"",width:t.canvasWidth*t.scaleRatio,height:t.canvasHeight*t.scaleRatio};t.isBase64=!1,t.isBase64?uni.canvasGetImageData({canvasId:"tui-image-cropper",x:0,y:0,width:t.canvasWidth*t.scaleRatio,height:Math.round(t.canvasHeight*t.scaleRatio),success:function(i){var a=new Uint8Array(i.data),n=uni.arrayBufferToBase64(a);e.base64=n,t.loadding&&uni.hideLoading(),t.$emit("cropper",e)}},t):uni.canvasToTempFilePath((0,n.default)((0,n.default)({},i),{},{canvasId:"tui-image-cropper",success:function(i){e.url=i.tempFilePath,e.base64=i.tempFilePath,t.loadding&&uni.hideLoading(),t.$emit("cropper",e)},fail:function(t){console.log(t)}}),t)}));case 9:case"end":return i.stop()}}),i)})));return function(){return i.apply(this,arguments)}}();this.CROPPER_WIDTH!=this.canvasWidth||this.CROPPER_HEIGHT!=this.canvasHeight?(this.CROPPER_WIDTH=this.canvasWidth,this.CROPPER_HEIGHT=this.canvasHeight,this.$nextTick((function(){t.ctx.draw(),setTimeout((function(){i()}),100)}))):i()}else uni.showToast({title:"请选择图片",icon:"none"})},change:function(t){this.cutX=t.cutX||0,this.cutY=t.cutY||0,this.canvasWidth=t.canvasWidth||this.width,this.canvasHeight=t.canvasHeight||this.height,this.imgWidth=t.imgWidth||this.imgWidth,this.imgHeight=t.imgHeight||this.imgHeight,this.scale=t.scale||1,this.angle=t.angle||0,this.imgTop=t.imgTop||0,this.imgLeft=t.imgLeft||0},imageReset:function(){this.scale=1,this.angle=0;var t=this.sysInfo.windowHeight?this.sysInfo:uni.getSystemInfoSync();this.imgTop=t.windowHeight/2,this.imgLeft=t.windowWidth/2,this.resetChange++,this.props="4,".concat(this.resetChange),this.$emit("initAngle",{})},imageLoad:function(t){this.imageReset(),uni.hideLoading(),this.$emit("imageLoad",{})},imgComputeSize:function(t,i){var e=t,a=i;if(e&&a)e/a>this.width/this.height?(a=this.height,e=t/i*a):(e=this.width,a=i/t*e);else{var n=this.sysInfo.windowHeight?this.sysInfo:uni.getSystemInfoSync();e=n.windowWidth,a=0}this.imgWidth=e,this.imgHeight=a,this.sizeChange++,this.props="2,".concat(this.sizeChange)},moveStop:function(){var t=this;clearTimeout(this.TIME_CUT_CENTER),this.TIME_CUT_CENTER=setTimeout((function(){t.cutAnimation||(t.cutAnimation=!0),t.centerChange++,t.props="5,".concat(t.centerChange)}),666)},moveDuring:function(){clearTimeout(this.TIME_CUT_CENTER)},showLoading:function(){uni.showLoading({title:"请稍候...",mask:!0})},stop:function(){},back:function(){uni.navigateBack()},angleChanged:function(t){this.moveStop(),this.limitMove&&t%90&&(this.angle=90*Math.round(t/90)),this.angleChange++,this.props="3,".concat(this.angleChange)},setAngle:function(){this.cutAnimation=!0,this.angle=this.angle+90,this.angleChanged(this.angle)}}};i.default=c},2323:function(t,i,e){"use strict";e.r(i);var a=e("dd98"),n=e.n(a);for(var o in a)"default"!==o&&function(t){e.d(i,t,(function(){return a[t]}))}(o);i["default"]=n.a},"2a7e":function(t,i,e){"use strict";var a;e.d(i,"b",(function(){return n})),e.d(i,"c",(function(){return o})),e.d(i,"a",(function(){return a}));var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-uni-view",{staticClass:"tui-container",on:{touchmove:function(i){i.stopPropagation(),i.preventDefault(),arguments[0]=i=t.$handleEvent(i),t.stop.apply(void 0,arguments)}}},[e("v-uni-view",{wxsProps:{"change:prop":"props"},staticClass:"tui-image-cropper",attrs:{"change:prop":t.parse.propsChange,prop:t.props,"data-lockRatio":t.lockRatio,"data-lockWidth":t.lockWidth,"data-lockHeight":t.lockHeight,"data-maxWidth":t.maxWidth,"data-minWidth":t.minWidth,"data-maxHeight":t.maxHeight,"data-minHeight":t.minHeight,"data-width":t.width,"data-height":t.height,"data-limitMove":t.limitMove,"data-windowHeight":t.sysInfo.windowHeight||600,"data-windowWidth":t.sysInfo.windowWidth||400,"data-imgTop":t.imgTop,"data-imgLeft":t.imgLeft,"data-imgWidth":t.imgWidth,"data-imgHeight":t.imgHeight,"data-angle":t.angle},on:{touchend:function(i){i=t.$handleWxsEvent(i),t.parse.cutTouchEnd(i,t.$getComponentDescriptor())},touchstart:function(i){i=t.$handleWxsEvent(i),t.parse.cutTouchStart(i,t.$getComponentDescriptor())},touchmove:function(i){i=t.$handleWxsEvent(i),t.parse.cutTouchMove(i,t.$getComponentDescriptor())}}},[e("v-uni-view",{staticClass:"tui-content"},[e("v-uni-view",{staticClass:"tui-content-top tui-bg-transparent",style:{transitionProperty:t.cutAnimation?"":"background"}}),e("v-uni-view",{staticClass:"tui-content-middle"},[e("v-uni-view",{staticClass:"tui-bg-transparent tui-wxs-bg",style:{transitionProperty:t.cutAnimation?"":"background"}}),e("v-uni-view",{staticClass:"tui-cropper-box",style:{borderColor:t.borderColor,transitionProperty:t.cutAnimation?"":"background"}},t._l(4,(function(i,a){return e("v-uni-view",{key:a,staticClass:"tui-edge",class:["tui-"+(a<2?"top":"bottom")+"-"+(0===a||2===a?"left":"right")],style:{width:t.edgeWidth,height:t.edgeWidth,borderColor:t.edgeColor,borderWidth:t.edgeBorderWidth,left:0===a||2===a?"-"+t.edgeOffsets:"auto",right:1===a||3===a?"-"+t.edgeOffsets:"auto",top:a<2?"-"+t.edgeOffsets:"auto",bottom:a>1?"-"+t.edgeOffsets:"auto"}})})),1),e("v-uni-view",{staticClass:"tui-flex-auto tui-bg-transparent",style:{transitionProperty:t.cutAnimation?"":"background"}})],1),e("v-uni-view",{staticClass:"tui-flex-auto tui-bg-transparent",style:{transitionProperty:t.cutAnimation?"":"background"}})],1),t.imageUrl?e("v-uni-image",{staticClass:"tui-cropper-image",style:{width:t.imgWidth?t.imgWidth+"px":"auto",height:t.imgHeight?t.imgHeight+"px":"auto",transitionDuration:(t.cutAnimation?.3:0)+"s"},attrs:{"data-minScale":t.minScale,"data-maxScale":t.maxScale,"data-disableRotate":t.disableRotate,src:t.imageUrl,mode:"widthFix"},on:{load:function(i){arguments[0]=i=t.$handleEvent(i),t.imageLoad.apply(void 0,arguments)},error:function(i){arguments[0]=i=t.$handleEvent(i),t.imageLoad.apply(void 0,arguments)},touchstart:function(i){i=t.$handleWxsEvent(i),t.parse.touchstart(i,t.$getComponentDescriptor())},touchmove:function(i){i=t.$handleWxsEvent(i),t.parse.touchmove(i,t.$getComponentDescriptor())},touchend:function(i){i=t.$handleWxsEvent(i),t.parse.touchend(i,t.$getComponentDescriptor())}}}):t._e()],1),e("v-uni-canvas",{staticClass:"tui-cropper-canvas",style:{width:t.CROPPER_WIDTH*t.scaleRatio+"px",height:t.CROPPER_HEIGHT*t.scaleRatio+"px"},attrs:{"canvas-id":"tui-image-cropper",id:"tui-image-cropper","disable-scroll":!0}}),t.custom?t._e():e("v-uni-view",{staticClass:"tui-cropper-tabbar"},[e("v-uni-view",{staticClass:"tui-op-btn",on:{click:function(i){i.stopPropagation(),arguments[0]=i=t.$handleEvent(i),t.back.apply(void 0,arguments)}}},[t._v("取消")]),e("v-uni-image",{staticClass:"tui-rotate-img",attrs:{src:t.rotateImg},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.setAngle.apply(void 0,arguments)}}}),e("v-uni-view",{staticClass:"tui-op-btn",on:{click:function(i){i.stopPropagation(),arguments[0]=i=t.$handleEvent(i),t.getImage.apply(void 0,arguments)}}},[t._v("完成")])],1)],1)},o=[]},"2a83":function(t,i,e){var a=e("24fb");i=a(!1),i.push([t.i,'.tui-container[data-v-1a52535e]{width:100vw;height:100vh;background-color:rgba(0,0,0,.6);position:fixed;top:0;left:0;z-index:1}.tui-image-cropper[data-v-1a52535e]{width:100vw;height:100vh;position:absolute}.tui-content[data-v-1a52535e]{width:100vw;height:100vh;position:absolute;z-index:9;display:flex;flex-direction:column;pointer-events:none}.tui-bg-transparent[data-v-1a52535e]{background-color:rgba(0,0,0,.6);transition-duration:.3s}.tui-content-top[data-v-1a52535e]{pointer-events:none}.tui-content-middle[data-v-1a52535e]{width:100%;height:200px;display:flex;box-sizing:border-box}.tui-cropper-box[data-v-1a52535e]{position:relative;\n\t/* transition-duration: 0.2s; */border-style:solid;border-width:%?1?%;box-sizing:border-box}.tui-flex-auto[data-v-1a52535e]{flex:auto}.tui-cropper-image[data-v-1a52535e]{width:100%;border-style:none;position:absolute;top:0;left:0;z-index:2;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-transform-origin:center;transform-origin:center}.tui-cropper-canvas[data-v-1a52535e]{position:fixed;z-index:10;left:-2000px;top:-2000px;pointer-events:none}.tui-edge[data-v-1a52535e]{border-style:solid;pointer-events:auto;position:absolute;box-sizing:border-box}.tui-top-left[data-v-1a52535e]{border-bottom-width:0!important;border-right-width:0!important}.tui-top-right[data-v-1a52535e]{border-bottom-width:0!important;border-left-width:0!important}.tui-bottom-left[data-v-1a52535e]{border-top-width:0!important;border-right-width:0!important}.tui-bottom-right[data-v-1a52535e]{border-top-width:0!important;border-left-width:0!important}.tui-cropper-tabbar[data-v-1a52535e]{width:100%;height:%?120?%;padding:0 %?40?%;box-sizing:border-box;position:fixed;left:0;bottom:0;z-index:99;display:flex;align-items:center;justify-content:space-between;color:#fff;font-size:%?32?%}.tui-cropper-tabbar[data-v-1a52535e]::after{content:" ";position:absolute;top:0;right:0;left:0;border-top:%?1?% solid hsla(0,0%,100%,.2);-webkit-transform:scaleY(.5) translateZ(0);transform:scaleY(.5) translateZ(0);-webkit-transform-origin:0 100%;transform-origin:0 100%}.tui-op-btn[data-v-1a52535e]{height:%?80?%;display:flex;align-items:center}.tui-rotate-img[data-v-1a52535e]{width:%?44?%;height:%?44?%}',""]),t.exports=i},"2ea9":function(t,i,e){"use strict";e.r(i);var a=e("3b56"),n=e("2323");for(var o in n)"default"!==o&&function(t){e.d(i,t,(function(){return n[t]}))}(o);var c,s=e("f0c5"),h=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,"0a79a01b",null,!1,a["a"],c);i["default"]=h.exports},"3b56":function(t,i,e){"use strict";e.d(i,"b",(function(){return n})),e.d(i,"c",(function(){return o})),e.d(i,"a",(function(){return a}));var a={tuiPictureCropper:e("114a").default},n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-uni-view",{staticClass:"container"},[e("tui-picture-cropper",{attrs:{lockRatio:!0,imageUrl:t.imageUrl},on:{ready:function(i){arguments[0]=i=t.$handleEvent(i),t.ready.apply(void 0,arguments)},cropper:function(i){arguments[0]=i=t.$handleEvent(i),t.cropper.apply(void 0,arguments)}}})],1)},o=[]},bfed:function(t,i,e){var a=e("2a83");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=e("4f06").default;n("ce82ebde",a,!0,{sourceMap:!1,shadowMode:!1})},dd98:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a={data:function(){return{src:"",imageUrl:""}},onLoad:function(t){this.src=t.src||"",this.src&&uni.showLoading({title:"请稍候...",mask:!0})},methods:{ready:function(){this.imageUrl=this.src},cropper:function(t){t.url?uni.previewImage({current:"",urls:[t.url]}):(console.log(t.base64),this.tui.toast("裁剪成功！查看控制台打印"))}}};i.default=a},de4e:function(t,i,e){"use strict";var a=function(t){(t.options.wxs||(t.options.wxs={}))["parse"]=function(t){var i={CUT_START:null,cutX:0,cutY:0,touchRelative:[{x:0,y:0}],flagCutTouch:!1,hypotenuseLength:0,flagEndTouch:!1,canvasWidth:0,canvasHeight:0,imgWidth:0,imgHeight:0,scale:1,angle:0,imgTop:0,imgLeft:0,limitMove:!0,minHeight:0,maxHeight:0,minWidth:0,maxWidth:0,windowHeight:0,windowWidth:0,init:!0};function e(t){return"true"===t||1==t}function a(t,e){var a=t.touches||t.changedTouches;if(i.flagEndTouch=!1,1==a.length)i.touchRelative[0]={x:a[0].pageX-i.imgLeft,y:a[0].pageY-i.imgTop};else{var n=Math.abs(a[0].pageX-a[1].pageX),o=Math.abs(a[0].pageY-a[1].pageY);i.touchRelative=[{x:a[0].pageX-i.imgLeft,y:a[0].pageY-i.imgTop},{x:a[1].pageX-i.imgLeft,y:a[1].pageY-i.imgTop}],i.hypotenuseLength=Math.sqrt(Math.pow(n,2)+Math.pow(o,2))}}function n(t){t&&t.callMethod("moveDuring")}function o(t){t&&t.callMethod("moveStop")}function c(t){var e=.5*(i.windowHeight-i.canvasHeight),a=.5*(i.windowWidth-i.canvasWidth);i.imgTop=i.imgTop-i.cutY+e,i.cutY=e,i.imgLeft=i.imgLeft-i.cutX+a,i.cutX=a,f(t),g(t),v(t),x(t)}function s(t,a){var o=t.touches||t.changedTouches;if(!i.flagEndTouch)if(n(a),1==t.touches.length){var c=o[0].pageX-i.touchRelative[0].x,s=o[0].pageY-i.touchRelative[0].y;i.imgLeft=c,i.imgTop=s,v(a),l(a)}else{var h=t.instance.getDataset(),u=+h.minscale,r=+h.maxscale,g=e(h.disablerotate),p=Math.abs(o[0].pageX-o[1].pageX),m=Math.abs(o[0].pageY-o[1].pageY),f=Math.sqrt(Math.pow(p,2)+Math.pow(m,2)),w=i.scale*(f/i.hypotenuseLength),T=0;w=w<=u?u:w,w=w>=r?r:w,i.scale=w,d(a,!0);var b=[{x:o[0].pageX-i.imgLeft,y:o[0].pageY-i.imgTop},{x:o[1].pageX-i.imgLeft,y:o[1].pageY-i.imgTop}];if(!g){var x=180/Math.PI*Math.atan2(b[0].y,b[0].x),y=180/Math.PI*Math.atan2(i.touchRelative[0].y,i.touchRelative[0].x),C=180/Math.PI*Math.atan2(b[1].y,b[1].x),H=180/Math.PI*Math.atan2(i.touchRelative[1].y,i.touchRelative[1].x),W=x-y,R=C-H;0!=W?T=W:0!=R&&(T=R)}i.touchRelative=b,i.hypotenuseLength=Math.sqrt(Math.pow(p,2)+Math.pow(m,2)),i.angle=i.angle+T,v(a)}}function h(t,e){i.flagEndTouch=!0,o(e),x(e)}function u(t,e){var a=t.touches||t.changedTouches,o=a[0].pageX,c=a[0].pageY,s=i.cutX-30,h=i.cutX+30,u=i.cutY-30,r=i.cutY+30,g=i.cutX+i.canvasWidth-30,d=i.cutX+i.canvasWidth+30,l=i.cutY+i.canvasHeight-30,p=i.cutY+i.canvasHeight+30;o>g&&o<d&&c>l&&c<p?(n(),i.flagCutTouch=!0,i.flagEndTouch=!0,i.CUT_START={width:i.canvasWidth,height:i.canvasHeight,x:o,y:c,corner:1}):o>g&&o<d&&c>u&&c<r?(n(),i.flagCutTouch=!0,i.flagEndTouch=!0,i.CUT_START={width:i.canvasWidth,height:i.canvasHeight,x:o,y:c,cutY:i.cutY,cutX:i.cutX,corner:2}):o>s&&o<h&&c>u&&c<r?(n(),i.flagCutTouch=!0,i.flagEndTouch=!0,i.CUT_START={width:i.canvasWidth,height:i.canvasHeight,cutY:i.cutY,cutX:i.cutX,x:o,y:c,corner:3}):o>s&&o<h&&c>l&&c<p&&(n(),i.flagCutTouch=!0,i.flagEndTouch=!0,i.CUT_START={width:i.canvasWidth,height:i.canvasHeight,cutY:i.cutY,cutX:i.cutX,x:o,y:c,corner:4})}function r(t,a){if(i.CUT_START&&"null"!==i.CUT_START&&i.flagCutTouch){var n=t.touches||t.changedTouches,o=t.instance.getDataset(),c=e(o.lockratio),s=e(o.lockwidth),h=e(o.lockheight);if(c&&(s||h))return;var u=i.canvasWidth,r=i.canvasHeight,g=i.cutY,l=i.cutX,p=function(){u=u<=i.maxWidth?u>=i.minWidth?u:i.minWidth:i.maxWidth,r=r<=i.maxHeight?r>=i.minHeight?r:i.minHeight:i.maxHeight},m=function(){return(u>i.maxWidth||u<i.minWidth||r>i.maxHeight||r<i.minHeight)&&c?(p(),!1):(p(),!0)};switch(r=i.CUT_START.height+(i.CUT_START.corner>1&&i.CUT_START.corner<4?1:-1)*(i.CUT_START.y-n[0].pageY),i.CUT_START.corner){case 1:if(u=i.CUT_START.width-i.CUT_START.x+n[0].pageX,c&&(r=u/(i.canvasWidth/i.canvasHeight)),!m())return;break;case 2:if(u=i.CUT_START.width-i.CUT_START.x+n[0].pageX,c&&(r=u/(i.canvasWidth/i.canvasHeight)),!m())return;g=i.CUT_START.cutY-(r-i.CUT_START.height);break;case 3:if(u=i.CUT_START.width+i.CUT_START.x-n[0].pageX,c&&(r=u/(i.canvasWidth/i.canvasHeight)),!m())return;g=i.CUT_START.cutY-(r-i.CUT_START.height),l=i.CUT_START.cutX-(u-i.CUT_START.width);break;case 4:if(u=i.CUT_START.width+i.CUT_START.x-n[0].pageX,c&&(r=u/(i.canvasWidth/i.canvasHeight)),!m())return;l=i.CUT_START.cutX-(u-i.CUT_START.width);break;default:break}s||h?s?h||(i.canvasHeight=r,i.cutY=g,b(a)):(i.canvasWidth=u,i.cutX=l,T(a)):(i.canvasWidth=u,i.cutX=l,i.canvasHeight=r,i.cutY=g,b(a),T(a)),f(a),d(a)}}function g(t){var e=i.windowHeight,a=i.windowWidth,n=function(){i.cutY<0&&(i.cutY=0),i.cutY>e-i.canvasHeight&&(i.cutY=e-i.canvasHeight)},o=function(){i.cutX<0&&(i.cutX=0),i.cutX>a-i.canvasWidth&&(i.cutX=a-i.canvasWidth)};if(null==i.cutY&&null==i.cutX){var c=.5*(e-i.canvasHeight),s=.5*(a-i.canvasWidth);i.cutY=c,i.cutX=s}else null!=i.cutY&&null!=i.cutX?(n(),o()):null!=i.cutY&&null==i.cutX?(n(),i.cutX=(a-i.canvasWidth)/2):null==i.cutY&&null!=i.cutX&&(o(),i.cutY=(e-i.canvasHeight)/2);f(t)}function d(t,e){if(i.limitMove){var a=i.scale,n=i.imgWidth,o=i.imgHeight;i.angle/90%2&&(n=i.imgHeight,o=i.imgWidth),n*a<i.canvasWidth&&(a=i.canvasWidth/n),o*a<i.canvasHeight&&(a=Math.max(a,i.canvasHeight/o)),l(t,a,e)}}function l(t,e,a){if(i.limitMove){var n=i.imgLeft,o=i.imgTop;e=e||i.scale;var c=i.imgWidth,s=i.imgHeight;i.angle/90%2&&(c=i.imgHeight,s=i.imgWidth),n=i.cutX+c*e/2>=n?n:i.cutX+c*e/2,n=i.cutX+i.canvasWidth-c*e/2<=n?n:i.cutX+i.canvasWidth-c*e/2,o=i.cutY+s*e/2>=o?o:i.cutY+s*e/2,o=i.cutY+i.canvasHeight-s*e/2<=o?o:i.cutY+i.canvasHeight-s*e/2,i.imgLeft=n,i.imgTop=o,i.scale=e,f(t),a&&"null"!==a||v(t)}}function p(t,e){o(e),i.flagCutTouch=!1,x(e)}function m(t){i.canvasWidth>i.windowWidth?i.canvasWidth=i.windowWidth:i.canvasWidth+i.cutX>i.windowWidth&&(i.cutX=i.windowWidth-i.cutX),i.canvasHeight>i.windowHeight?i.canvasHeight=i.windowHeight:i.canvasHeight+i.cutY>i.windowHeight&&(i.cutY=i.windowHeight-i.cutY)}function f(t){t&&(t.selectComponent(".tui-cropper-box").setStyle({width:i.canvasWidth+"px",height:i.canvasHeight+"px"}),t.selectComponent(".tui-content-middle").setStyle({height:i.canvasHeight+"px"}),t.selectComponent(".tui-content-top").setStyle({height:i.cutY+"px"}),t.selectComponent(".tui-wxs-bg").setStyle({width:i.cutX+"px"}))}function v(t){var e=t.selectComponent(".tui-cropper-image");if(e){var a=i.imgLeft-i.imgWidth/2,n=i.imgTop-i.imgHeight/2;e.setStyle({transform:"translate3d("+a+"px,"+n+"px,0) scale("+i.scale+") rotate("+i.angle+"deg)"})}}function w(t){i.scale=1,i.angle=0,v(t)}function T(t){i.canvasWidth<i.minWidth&&(i.canvasWidth=i.minWidth),t&&m(t)}function b(t){i.canvasHeight<i.minHeight&&(i.canvasHeight=i.minHeight),t&&m(t)}function x(t){t&&t.callMethod("change",{cutX:i.cutX,cutY:i.cutY,canvasWidth:i.canvasWidth,canvasHeight:i.canvasHeight,imgWidth:i.imgWidth,imgHeight:i.imgHeight,scale:i.scale,angle:i.angle,imgTop:i.imgTop,imgLeft:i.imgLeft})}function y(t,a,n,o){if(t&&"null"!==t){var s=t.split(","),h=+s[0],u=o.getDataset();switch(i.init||4==h?(i.maxHeight=+u.maxheight,i.minHeight=+u.minheight,i.maxWidth=+u.maxwidth,i.minWidth=+u.minwidth,i.canvasWidth=+u.width,i.canvasHeight=+u.height,i.imgTop=u.windowheight/2,i.imgLeft=u.windowwidth/2,i.imgWidth=+u.imgwidth,i.imgHeight=+u.imgheight,i.windowHeight=+u.windowheight,i.windowWidth=+u.windowwidth,i.init=!1):2!=h&&3!=h||(i.imgWidth=+u.imgwidth,i.imgHeight=+u.imgheight),i.limitMove=e(u.limitmove),i.angle=+u.angle,3==h&&v(n),h){case 1:c(n),m(n),g(n);break;case 2:c(n);break;case 3:d(n);break;case 4:w(n);break;case 5:c(n);break;default:break}}}return t.exports={touchstart:a,touchmove:s,touchend:h,cutTouchStart:u,cutTouchMove:r,cutTouchEnd:p,propsChange:y},t.exports}({exports:{}})};i["a"]=a}}]);